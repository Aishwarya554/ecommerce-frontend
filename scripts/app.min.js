console.log("Script loaded!");let allProducts=[];const hamburger=document.getElementById("hamburger"),navLinks=document.querySelector(".nav-links");hamburger.addEventListener("click",()=>{navLinks.classList.toggle("active"),hamburger.classList.toggle("open")});const grid=document.getElementById("product-grid"),loading=document.getElementById("loading"),error=document.getElementById("error"),API_URL="https://fakestoreapi.com/products";loading.style.display="block",error.style.display="none";const cached=localStorage.getItem("products");if(cached){let t=JSON.parse(cached);displayProducts(t),loading.style.display="none"}function displayProducts(t){grid.innerHTML="",t.forEach(t=>{let e=document.createElement("div");e.className="product-card",e.innerHTML=`
      <a href="product.html?id=${t.id}" class="product-link">
        <img data-src="${t.image}" alt="${t.title||t.name}" class="lazy-img">
        <h3>${t.title||t.name}</h3>
      </a>
      <p>$${t.price}</p>
      <button>Add to Cart</button>
    `,grid.appendChild(e)}),initLazyLoading()}function updateCartCount(){let t=JSON.parse(localStorage.getItem("cart"))||[],e=document.querySelector(".cart-count");if(e){let r=t.reduce((t,e)=>t+(e.quantity||1),0);e.textContent=r}}function initLazyLoading(){let t=document.querySelectorAll(".lazy-img");if("IntersectionObserver"in window){let e=new IntersectionObserver((t,r)=>{t.forEach(t=>{if(t.isIntersecting){let r=t.target;r.src=r.dataset.src,r.classList.remove("lazy-img"),e.unobserve(r)}})});t.forEach(t=>e.observe(t))}else t.forEach(t=>{t.src=t.dataset.src})}fetch("https://fakestoreapi.com/products").then(t=>{if(!t.ok)throw Error("Network response was not ok");return t.json()}).then(t=>{allProducts=t,localStorage.setItem("products",JSON.stringify(t)),console.log("Products saved to localStorage!"),cached||(displayProducts(t),loading.style.display="none")}).catch(t=>{console.error("Failed to fetch products:",t),cached||(loading.style.display="none",error.style.display="block")}),document.addEventListener("click",function(t){if(t.target&&"Add to Cart"===t.target.textContent){let e=t.target.closest(".product-card"),r=e.querySelector("h3").textContent,a=e.querySelector("p").textContent,s=e.querySelector("img").src,o={name:r,price:a,image:s,quantity:1},n=JSON.parse(localStorage.getItem("cart"))||[],c=n.findIndex(t=>t.name===o.name&&t.image===o.image);-1!==c?n[c].quantity+=1:n.push(o),localStorage.setItem("cart",JSON.stringify(n)),updateCartCount();let l=document.getElementById("cart-message");l&&(l.classList.add("show"),setTimeout(()=>{l.classList.remove("show")},2e3))}}),updateCartCount();const searchInput=document.querySelector(".search-bar");searchInput.addEventListener("input",t=>{let e=t.target.value.toLowerCase(),r=allProducts.filter(t=>{let r=t.title||t.name||"",a=t.category||"";return r.toLowerCase().includes(e)||a.toLowerCase().includes(e)});displayProducts(r)});